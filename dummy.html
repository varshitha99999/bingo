<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python Bug Bingo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  
    <link rel="stylesheet" href="styles.css">


</head>
<body>
   <script>
        document.addEventListener("DOMContentLoaded", function () {
            let selectedLanguage = localStorage.getItem("selectedLanguage");
            
            if (!selectedLanguage) {
                alert("No language selected! Redirecting...");
                window.location.href = "front.html";
            } else {
                console.log("Language Selected:", selectedLanguage);
                // Now you can filter questions based on selectedLanguage
            }
        });
    </script>
    <div class="container py-5">
        <div class="row">
            <div class="col-lg-8">
                <!-- Header with BINGO Letters -->
                <div class="game-header text-center">
                    <h1 class="game-title">Python Bug Bingo</h1>
                    <div class="bingo-track" id="bingoProgress">
                        <div class="bingo-letter" style="background-color: #FF6B6B;">B</div>
                        <div class="bingo-letter" style="background-color: #4ECDC4;">I</div>
                        <div class="bingo-letter" style="background-color: #45B7D1;">N</div>
                        <div class="bingo-letter" style="background-color: #A5D8FF;">G</div>
                        <div class="bingo-letter" style="background-color: #FFD8A8;">O</div>
                    </div>
                </div>
                
                <!-- Bingo Grid -->
                <div id="grid"></div>
            </div>
            
            <div class="col-lg-4">
                <!-- Leaderboard -->
                <div class="leaderboard-container">
                    <h3 class="leaderboard-header text-center">Leaderboard</h3>
                    <ul class="leaderboard-list" id="leaderboard">
                        <li class="text-center py-3">Waiting for players...</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Help Button -->
    <div class="help-btn" data-bs-toggle="modal" data-bs-target="#helpModal">?</div>

    <!-- Help Modal -->
    <div class="modal fade" id="helpModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">How to Play Python Bug Bingo</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <h6>Game Rules:</h6>
                    <ol>
                        <li>Enter your player name to join the game</li>
                        <li>Click on any bug cell to reveal a Python code snippet with a bug</li>
                        <li>Fix the bug in the code editor and submit your solution</li>
                        <li>If correct, the cell turns green permanently and you earn points</li>
                        <li>Complete a row, column, or diagonal to mark a BINGO letter</li>
                        <li>Complete all 5 letters in BINGO to win!</li>
                        <li>Compete with others on the live leaderboard</li>
                    </ol>
                    <h6 class="mt-3">Scoring:</h6>
                    <ul>
                        <li>Correct bug fix: +10 points</li>
                        <li>Completed BINGO line: +50 points</li>
                        <li>Completed full BINGO: +100 points</li>
                    </ul>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Got it!</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Player Name Modal -->
    <div class="modal fade player-modal" id="playerModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Enter Your Name</h5>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="playerName" class="form-label">Choose a name to join the game:</label>
                        <input type="text" class="form-control" id="playerName" placeholder="e.g. PythonPro" maxlength="20">
                        <div class="form-text">This will be displayed on the leaderboard</div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="joinGameBtn" type="button" class="btn btn-primary">Join Game</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bugged Code Modal -->
    <div class="modal fade" id="buggedCodeModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Fix the Bug</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <h6>Bugged Code:</h6>
                    <pre id="buggedCode"></pre>
                    
                    <div class="test-case-info bg-light p-3 rounded mb-3">
                        <div id="testCase"></div>
                        <div id="expectedOutput" class="mt-2"></div>
                    </div>
                    
                    <h6>Your Solution:</h6>
                    <textarea id="userCode" class="form-control mb-3" 
                              placeholder="Enter your corrected code here..." 
                              rows="8" spellcheck="false"></textarea>
                    
                    <div id="testCasesResult"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button id="submitBtn" type="button" class="btn btn-primary">Submit</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Win Celebration Modal -->
    <div class="win-celebration" id="winCelebration">
        <div class="win-text">CONGRATULATIONS!</div>
        <div class="win-subtext">You've fixed all the bugs and won Python Bug Bingo!</div>
        <div class="win-subtext mt-3" id="finalScoreText"></div>
    </div>

    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Confetti JS -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <script>
        // Bug data for Python
        const bug_data_python = {
            "bug_1": {
    "code": "def fibonacci(n):\n    if n == 0:\n        return 1\n    if n == 1:\n        return 1\n    return fibonacci(n - 1) + fibonacci(n - 2)",
    "test_case": "fibonacci(5)",
    "expected_output": "5",
    "actual_test_case": "fibonacci(0)",
    "actual_output": "1"
},
            
    "bug_2": {
        "code": "def factorial(n):\n    return n * factorial(n - 1)",
        "test_case": "factorial(5)",
        "expected_output": "120",
        "hidden_test_case": "factorial(3)",
        "hidden_expected_output": "6"
    },
    "bug_3": {
        "code": "def merge_sort(arr):\n    if len(arr) < 1:\n        return arr\n    mid = len(arr) // 2\n    left = merge_sort(arr[:mid])\n    right = merge_sort(arr[mid:])\n    return merge(left, right)",
        "test_case": "merge_sort([4, 3, 2, 1])",
        "expected_output": "[1, 2, 3, 4]",
        "hidden_test_case": "merge_sort([9, 7, 5, 3])",
        "hidden_expected_output": "[3, 5, 7, 9]"
    },
    "bug_4": {
        "code": "def binary_search(arr, target):\n    mid = len(arr) // 2\n    if arr[mid] == target:\n        return mid\n    elif arr[mid] > target:\n        return binary_search(arr[:mid], target)\n    else:\n        return binary_search(arr[mid:], target)",
        "test_case": "binary_search([1, 3, 5, 7, 9], 5)",
        "expected_output": "2",
        "hidden_test_case": "binary_search([10, 20, 30, 40, 50], 40)",
        "hidden_expected_output": "3"
    },
    "bug_5": {
        "code": "def is_palindrome(s):\n    return s.lower() == s[::-1]",
        "test_case": "is_palindrome('Madam'), is_palindrome('hello')",
        "expected_output": "True, False",
        "hidden_test_case": "is_palindrome('racear'), is_palindrome('python')",
        "hidden_expected_output": "False, False"
    },
    "bug_6": {
        "code": "def quicksort(arr):\n    if len(arr) < 1:\n        return arr\n    pivot = arr[0]\n    left = [x for x in arr if x < pivot]\n    right = [x for x in arr if x >= pivot]\n    return quicksort(left) + [pivot] + quicksort(right)",
        "test_case": "quicksort([3, 6, 8, 10, 1, 2, 1])",
        "expected_output": "[1, 1, 2, 3, 6, 8, 10]",
        "hidden_test_case": "quicksort([20, 15, 10, 5])",
        "hidden_expected_output": "[5, 10, 15, 20]"
    },


        "bug_7": {
        "code": "def gcd(a, b):\n    while b:\n        a = b\n        b = a % b\n    return abs(a)",
        "test_case": "gcd(-8, 12)",
        "expected_output": "4",
        "hidden_test_case": "gcd(48, 18)",
        "hidden_expected_output": "6"
    },
    "bug_8": {
        "code": "def bubble_sort(arr):\n    for i in range(len(arr)):\n        for j in range(len(arr) - i - 1):\n            if arr[j] > arr[j + 1]:\n                arr[j], arr[j + 1] = arr[j + 1], arr[j]\n    return arr",
        "test_case": "bubble_sort([5, 3, 8, 1, 2])",
        "expected_output": "[1, 2, 3, 5, 8]",
        "hidden_test_case": "bubble_sort([10, 9, 8, 7, 6])",
        "hidden_expected_output": "[6, 7, 8, 9, 10]"
    },
    "bug_9": {
        "code": "def reverse_string(s):\n    return s[::-2]",
        "test_case": "reverse_string(\"hello\")",
        "expected_output": "'olleh'",
        "hidden_test_case": "reverse_string(\"Python\")",
        "hidden_expected_output": "'nohtyP'"
    },
    "bug_10": {
        "code": "def sum_list(lst):\n    total = 0\n    for i in range(len(lst) + 1):\n        total += lst[i]\n    return total",
        "test_case": "sum_list([1, 2, 3, 4])",
        "expected_output": "10",
        "hidden_test_case": "sum_list([5, 10, 15])",
        "hidden_expected_output": "30"
    },
            "bug_11": {
        "code": "def count_vowels(s):\n    count = 0\n    for char in s:\n        if char in 'aeiou':\n            count += 1\n    return count",
        "test_case": "count_vowels('Hello World')",
        "expected_output": "3",
        "hidden_test_case": "count_vowels('AEIOUaeiou')",
        "hidden_expected_output": "10"
    },
    "bug_12": {
        "code": "def power(x, n):\n    if n == 0:\n        return 1\n    elif n < 0:\n        return 1 / power(x, -n)\n    return x * power(x, n - 1)",
        "test_case": "power(2, 3)",
        "expected_output": "8",
        "hidden_test_case": "power(5, -2)",
        "hidden_expected_output": "0.04"
    },
    "bug_13": {
        "code": "def remove_duplicates(lst):\n    seen = []\n    return [x for x in lst if not (x in seen or seen.append(x))]",
        "test_case": "remove_duplicates([1, 3, 3, 5, 5])",
        "expected_output": "[1, 3, 5]",
        "hidden_test_case": "remove_duplicates(['a', 'b', 'A', 'b'])",
        "hidden_expected_output": "['a', 'b', 'A']"
    },
    "bug_14": {
        "code": "def multiply_list(lst):\n    result = 1\n    for num in lst:\n        result *= num\n    return result if result != 0 else 1",
        "test_case": "multiply_list([2, 3, 4])",
        "expected_output": "24",
        "hidden_test_case": "multiply_list([7, 0, 5])",
        "hidden_expected_output": "0"
    },
    "bug_15": {
        "code": "def find_max(lst):\n    max_num = lst[0]\n    for num in lst:\n        if num >= max_num:\n            max_num = num\n    return max_num",
        "test_case": "find_max([1, 5, 3, 9, 2])",
        "expected_output": "9",
        "hidden_test_case": "find_max([-1, -5, -3, -9, -2])",
        "hidden_expected_output": "-1"
    },
            
    "bug_16": {
        "code": "def count_words(s):\n    words = s.split()\n    return len(words) + 1",
        "test_case": "count_words(\"Hello world! This is a test.\")",
        "expected_output": "6",
        "hidden_test_case": "count_words(\"One two   three    four\")",
        "hidden_expected_output": "4"
    },
    "bug_17": {
        "code": "def anagram_check(s1, s2):\n    return sorted(s1.lower()) == sorted(s2)",
        "test_case": "anagram_check(\"Listen\", \"Silent\")",
        "expected_output": "True",
        "hidden_test_case": "anagram_check(\"Astronomer\", \"Moon starer\")",
        "hidden_expected_output": "True"
    },
    "bug_18": {
        "code": "def find_min(lst):\n    min_num = lst[0]\n    for num in lst:\n        if num > min_num:\n            min_num = num\n    return min_num",
        "test_case": "find_min([4, 2, 9, 1])",
        "expected_output": "1",
        "hidden_test_case": "find_min([-10, -50, -3, -1])",
        "hidden_expected_output": "-50"
    },
    "bug_19": {
        "code": "def is_leap_year(year):\n    if (year % 4 == 0 and year % 100 != 0) or year % 400 == 0:\n        return False\n    return True",
        "test_case": "is_leap_year(2000), is_leap_year(1900)",
        "expected_output": "True, False",
        "hidden_test_case": "is_leap_year(2024)",
        "hidden_expected_output": "True"
    },
    "bug_20": {
        "code": "def square_elements(lst):\n    return [x*x for x in lst if x >= 0]",
        "test_case": "square_elements([1, 2, 3, 4, -1, -2])",
        "expected_output": "[1, 4, 9, 16]",
        "hidden_test_case": "square_elements([-3, -2, -1, 0])",
        "hidden_expected_output": "[0]"
    },

    "bug_21": {
        "code": "def count_occurrences(lst, target):\n    count = 0\n    for num in lst:\n        if num = target:\n            count += 1\n    return count",
        "test_case": "count_occurrences([1, 2, 2, 3, 4, 2], 2)",
        "expected_output": "3",
        "hidden_test_case": "count_occurrences([5, 5, 5, 5, 5], 5)",
        "hidden_expected_output": "5"
    },
    "bug_22": {
        "code": "def reverse_list(lst):\n    return lst.sort()",
        "test_case": "reverse_list([5, 3, 8, 1, 2])",
        "expected_output": "[8, 5, 3, 2, 1]",
        "hidden_test_case": "reverse_list([])",
        "hidden_expected_output": "[]"
    },
    "bug_23": {
        "code": "def word_count(sentence):\n    words = sentence.split()\n    return {word: words.count(word) for word in set(words)}",
        "test_case": "word_count(\"apple banana apple orange apple banana\")",
        "expected_output": "{'apple': 3, 'banana': 2, 'orange': 1}",
        "hidden_test_case": "word_count(\"Python Python python PYTHON python\")",
        "hidden_expected_output": "{'Python': 2, 'python': 3}"
    },
    "bug_24": {
        "code": "def capitalize_names(names):\n    return [name.capitalize for name in names]",
        "test_case": "capitalize_names(['alice', 'bob', 'charlie'])",
        "expected_output": "['Alice', 'Bob', 'Charlie']",
        "hidden_test_case": "capitalize_names([''])",
        "hidden_expected_output": "['']"
    },
    "bug_25": {
        "code": "def get_even_numbers(lst):\n    return filter(lambda x: x % 2 == 0, lst)",
        "test_case": "get_even_numbers([1, 2, 3, 4, 5, 6])",
        "expected_output": "[2, 4, 6]",
        "hidden_test_case": "get_even_numbers([1, 3, 5, 7])",
        "hidden_expected_output": "[]"
    }


        };

        // Game state
        const bugDataArray = Object.values(bug_data_python).slice(0, 25);
        let bingoState = {
            rows: new Array(5).fill(0),
            cols: new Array(5).fill(0),
            diagonal1: 0,
            diagonal2: 0
        };
        let completedCells = new Array(5).fill().map(() => new Array(5).fill(false));
        let completedLetters = 0;
        let correctAnswers = new Set();
        
        // Player and leaderboard state
        let player = {
            name: "",
            score: 0,
            completedBugs: 0,
            completedLines: 0,
            hasBingo: false
        };
        
        // Simulated players data
        
        
        let leaderboard = [];

        // Initialize the game
        document.addEventListener('DOMContentLoaded', () => {
            // Show player name modal first
            const playerModal = new bootstrap.Modal(document.getElementById('playerModal'));
            playerModal.show();
            
            // Set up join game button
            document.getElementById('joinGameBtn').addEventListener('click', joinGame);
            
            // Initialize empty leaderboard
            updateLeaderboard();
            
            // Simulate other players joining
            setTimeout(() => {
                leaderboard = [...simulatedPlayers];
                updateLeaderboard();
                
                // Simulate periodic score updates
                
            }, 2000);
        });

        function joinGame() {
            const playerName = document.getElementById('playerName').value.trim();
            if (playerName.length < 2) {
                alert("Please enter a name with at least 2 characters");
                return;
            }
            
            player.name = playerName;
            player.score = 0;
            player.completedBugs = 0;
            player.completedLines = 0;
            player.hasBingo = false;
            
            // Add player to leaderboard
            leaderboard.push({...player});
            
            // Close modal and start game
            const playerModal = bootstrap.Modal.getInstance(document.getElementById('playerModal'));
            playerModal.hide();
            
            createGrid();
            updateLeaderboard();
        }

        function createGrid() {
            const grid = document.getElementById('grid');
            grid.innerHTML = '';
            
            for (let i = 0; i < 5; i++) {
                for (let j = 0; j < 5; j++) {
                    const index = i * 5 + j;
                    const cell = document.createElement('div');
                    cell.className = 'bug-cell';
                    cell.dataset.row = i;
                    cell.dataset.col = j;
                    cell.dataset.index = index;
                    cell.innerHTML = '🐛';
                    
                    cell.addEventListener('click', function() {
                        const clickedIndex = parseInt(this.dataset.index);
                        if (!correctAnswers.has(clickedIndex)) {
                            openModal(i, j, clickedIndex);
                        }
                    });
                    
                    grid.appendChild(cell);
                }
            }
        }

        function openModal(row, col, index) {
            const bugData = bugDataArray[index];
            
            if (!bugData) {
                console.error('No bug data found for index:', index);
                return;
            }
            
            document.getElementById('buggedCode').textContent = bugData.code;
            document.getElementById('testCase').textContent = `Test Case: ${bugData.test_case}`;
            document.getElementById('expectedOutput').textContent = `Expected Output: ${bugData.expected_output}`;
            document.getElementById('userCode').value = '';
            document.getElementById('testCasesResult').innerHTML = '';
            
            document.getElementById('submitBtn').onclick = function() {
                submitSolution(row, col, index, bugData);
            };
            
            const modal = new bootstrap.Modal(document.getElementById('buggedCodeModal'));
            modal.show();
        }

        function submitSolution(row, col, index, bugData) {
            const userCode = document.getElementById('userCode').value.trim();
            const isCorrect = userCode.length > 0 && userCode !== bugData.code;
            
            if (isCorrect) {
                // Mark as permanently correct
                correctAnswers.add(index);
                completedCells[row][col] = true;
                
                // Update cell appearance
                const cell = document.querySelector(`[data-row="${row}"][data-col="${col}"]`);
                cell.classList.add('correct');
                cell.innerHTML = '✅';
                
                // Update player score and stats
                player.score += 10;
                player.completedBugs++;
                
                // Update Bingo state
                bingoState.rows[row]++;
                bingoState.cols[col]++;
                if (row === col) bingoState.diagonal1++;
                if (row + col === 4) bingoState.diagonal2++;
                
                // Update leaderboard
                updatePlayerInLeaderboard();
                updateLeaderboard();
                
                // Trigger confetti
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                
                // Check for completed lines
                checkBingo();
                
                // Show success message
                document.getElementById('testCasesResult').innerHTML = `
                    <div class="alert alert-success d-flex align-items-center">
                        ✅ Correct! +10 points!
                    </div>
                `;
                
                // Close modal after delay
                setTimeout(() => {
                    const modal = bootstrap.Modal.getInstance(document.getElementById('buggedCodeModal'));
                    modal.hide();
                }, 1500);
            } else {
                document.getElementById('testCasesResult').innerHTML = `
                    <div class="alert alert-danger d-flex align-items-center">
                        ❌ Incorrect, try again!
                    </div>
                `;
            }
        }

        function checkBingo() {
            // Check rows
            for (let i = 0; i < 5; i++) {
                if (bingoState.rows[i] === 5 && completedLetters < 5) {
                    completeBingoLetter();
                    bingoState.rows[i] = 0; // Reset to prevent multiple triggers
                    return;
                }
            }
            
            // Check columns
            for (let j = 0; j < 5; j++) {
                if (bingoState.cols[j] === 5 && completedLetters < 5) {
                    completeBingoLetter();
                    bingoState.cols[j] = 0; // Reset
                    return;
                }
            }
            
            // Check diagonals
            if (bingoState.diagonal1 === 5 && completedLetters < 5) {
                completeBingoLetter();
                bingoState.diagonal1 = 0; // Reset
                return;
            }
            
            if (bingoState.diagonal2 === 5 && completedLetters < 5) {
                completeBingoLetter();
                bingoState.diagonal2 = 0; // Reset
                return;
            }
        }

        function completeBingoLetter() {
            if (completedLetters < 5) {
                const letters = document.querySelectorAll('.bingo-letter');
                letters[completedLetters].classList.add('completed');
                
                // Update player score and stats
                player.score += 50;
                player.completedLines++;
                
                // Update leaderboard
                updatePlayerInLeaderboard();
                updateLeaderboard();
                
                // Big confetti for letter completion
                confetti({
                    particleCount: 150,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                
                completedLetters++;
                
                // Check for full BINGO
                if (completedLetters === 5) {
                    player.score += 100;
                    player.hasBingo = true;
                    updatePlayerInLeaderboard();
                    updateLeaderboard();
                    setTimeout(showWinCelebration, 1000);
                }
            }
        }

        function showWinCelebration() {
            const celebration = document.getElementById('winCelebration');
            const finalScoreText = document.getElementById('finalScoreText');
            finalScoreText.textContent = `Final Score: ${player.score} points`;
            celebration.classList.add('active');
            
            // Mega confetti blast
            confetti({
                particleCount: 500,
                spread: 120,
                origin: { y: 0.6 }
            });
        }
        
        function updatePlayerInLeaderboard() {
            // Find player in leaderboard
            const playerIndex = leaderboard.findIndex(p => p.name === player.name);
            if (playerIndex !== -1) {
                leaderboard[playerIndex] = {...player};
            }
            
            // Sort leaderboard by score
            leaderboard.sort((a, b) => b.score - a.score);
        }
        
        function updateLeaderboard() {
            const leaderboardElement = document.getElementById('leaderboard');
            leaderboardElement.innerHTML = '';
            
            if (leaderboard.length === 0) {
                leaderboardElement.innerHTML = '<li class="text-center py-3">Be the first to join!</li>';
                return;
            }
            
            // Find max score for progress bars
            const maxScore = Math.max(...leaderboard.map(p => p.score), 100);
            
            leaderboard.forEach((playerData, index) => {
                const isCurrentPlayer = playerData.name === player.name;
                const li = document.createElement('li');
                li.className = `leaderboard-item ${isCurrentPlayer ? 'me' : ''}`;
                
                li.innerHTML = `
                    <div class="leaderboard-rank">${index + 1}</div>
                    <div class="leaderboard-name">
                        ${playerData.name}
                        ${playerData.hasBingo ? '🏆' : ''}
                        <div class="leaderboard-progress">
                            <div class="leaderboard-progress-bar" style="width: ${(playerData.score / maxScore) * 100}%"></div>
                        </div>
                    </div>
                    <div class="leaderboard-score">${playerData.score}</div>
                `;
                
                leaderboardElement.appendChild(li);
            });
        }
    </script>
</body>
</html>
